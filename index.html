<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¦ºé†’è¨ˆç•«ï¼šæœªä¾†æˆ°ç•¥äººæ ¼è©•å®š</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@500;700;900&display=swap');

        :root { 
            --p1: #00f2fe; 
            --p2: #4facfe; 
            --accent: #ff007a; 
            --bg: #050a14; 
            --gold: #f9d423;
            --text-bright: #ffffff;
            --text-dim: #cbd5e1;
            --urgent: #ff4757;
        }

        /* é‡è¨­åŸºç¤æ¨£å¼ï¼Œå„ªåŒ–æ‰‹æ©Ÿè§¸æ§ */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background: var(--bg); 
            color: var(--text-dim); 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start; /* æ”¹ç‚ºé ‚ç«¯å°é½Šï¼Œé¿å…å…§å®¹éé•·æ™‚ä¸­é–“è¢«åˆ‡æ‰ */
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-text-size-adjust: 100%;
            padding-top: 20px;
            padding-bottom: 20px;
        }

        .card { 
            width: 94%; 
            max-width: 500px; 
            background: rgba(15, 23, 42, 0.96); 
            padding: 1.5rem; 
            border-radius: 24px; 
            border: 2px solid rgba(0, 242, 254, 0.4); 
            box-shadow: 0 20px 60px rgba(0,0,0,0.9); 
            text-align: center; 
            position: relative;
            margin: 0 auto;
        }

        h1 { 
            font-size: 1.3rem; 
            color: var(--text-bright); 
            margin-bottom: 1.2rem; 
            letter-spacing: 1.2px; 
            font-weight: 900;
            line-height: 1.4;
        }

        .mbti-code { 
            font-size: clamp(2.2rem, 8vw, 3.2rem); 
            font-weight: 900; 
            background: linear-gradient(135deg, var(--p1), var(--accent)); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
            margin: 5px 0; 
            font-family: 'Orbitron', sans-serif; 
            letter-spacing: 4px; 
        }

        /* å¾¹åº•ä¿®æ­£æ‰‹æ©Ÿç‰ˆ ... åˆ‡å­—å•é¡Œ */
        .option { 
            display: block; 
            width: 100%; 
            padding: 1rem 1.1rem; 
            margin: 10px 0; 
            background: rgba(255,255,255,0.1); 
            border: 1px solid rgba(0, 242, 254, 0.3); 
            border-radius: 12px; 
            color: var(--text-bright); 
            text-align: left; 
            cursor: pointer; 
            transition: 0.2s; 
            font-size: 0.95rem; 
            font-weight: 700;
            white-space: normal; /* ç¢ºä¿æ–‡å­—å¯æ›è¡Œ */
            overflow: visible;   /* ç§»é™¤éš±è— */
            text-overflow: clip; /* ç§»é™¤çœç•¥è™Ÿ */
            line-height: 1.5;
            word-break: break-word;
        }

        .option:hover, .option:active { background: rgba(0, 242, 254, 0.15); border-color: var(--p1); }
        .option.selected { background: rgba(0, 242, 254, 0.25); border-color: var(--p1); box-shadow: 0 0 15px rgba(0, 242, 254, 0.3); }

        .progress-bar { height: 6px; background: #1e293b; border-radius: 3px; margin-bottom: 1.5rem; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--p1), var(--accent)); width: 0%; transition: 0.4s; }

        .hidden { display: none !important; }

        #processing { padding: 30px 0; }
        .loading-text { color: var(--p1); font-family: 'Orbitron'; font-weight: 900; letter-spacing: 2px; margin-bottom: 20px; display: block; }
        .long-progress { height: 10px; background: #1e293b; border-radius: 5px; overflow: hidden; width: 85%; margin: 0 auto; }
        .long-progress-fill { height: 100%; background: linear-gradient(90deg, var(--p1), var(--accent)); width: 0%; transition: width 0.3s ease-out; }

        .section-box { text-align: left; background: rgba(0,0,0,0.5); padding: 15px; border-radius: 16px; margin-top: 12px; border-left: 4px solid var(--accent); }
        .section-label { color: var(--p1); font-size: 0.8rem; font-weight: 900; margin-bottom: 6px; display: block; font-family: 'Orbitron', sans-serif; }
        .section-text { font-size: 0.9rem; line-height: 1.6; color: var(--text-bright); }

        /* åœ–è¡¨è‡ªé©æ‡‰è¨­å®š */
        .chart-container { 
            margin: 5px auto; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            width: 100%; 
            overflow: visible; 
            min-height: 300px;
        }
        #radarChart { 
            max-width: 100%;
            height: auto;
        }

        .match-tag { background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); padding: 5px 10px; border-radius: 10px; font-size: 0.8rem; color: var(--text-bright); font-weight: 900; }
        .match-tag b { color: var(--p1); font-family: 'Orbitron'; }

        .cta-btn { background: linear-gradient(90deg, var(--p1), var(--p2)); color: #000; border: none; padding: 1.1rem; border-radius: 14px; font-size: 1.1rem; font-weight: 900; width: 100%; cursor: pointer; margin-top: 15px; transition: 0.3s; display: block; text-decoration: none; text-align: center; }
        .cta-btn:hover { filter: brightness(1.1); transform: scale(1.02); box-shadow: 0 0 25px rgba(0, 242, 254, 0.5); }

        .urgent-tag { background: var(--urgent); color: white; font-size: 0.75rem; padding: 5px 12px; border-radius: 50px; font-weight: 900; display: inline-block; margin-bottom: 10px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        .social-toast { position: fixed; bottom: 20px; left: 10px; right: 10px; background: #1e293b; border: 2px solid var(--p1); padding: 12px; border-radius: 16px; display: flex; align-items: center; gap: 12px; box-shadow: 0 15px 40px rgba(0,0,0,0.6); z-index: 2000; transform: translateY(200%); transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .social-toast.show { transform: translateY(0); }
        .toast-avatar { width: 32px; height: 32px; background: var(--p1); border-radius: 50%; display:flex; align-items:center; justify-content:center; color:#000; font-weight:900; font-size:12px; flex-shrink: 0; }
        .toast-body { color: var(--text-bright); font-size: 13px; line-height: 1.3; text-align: left; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.96); display: none; justify-content: center; align-items: center; z-index: 3000; overflow-y: auto; padding: 15px; }
        .modal-content { background: linear-gradient(135deg, #881337, #4c0519); padding: 25px 20px; border-radius: 24px; border: 3px solid var(--gold); max-width: 450px; width: 100%; text-align: center; box-shadow: 0 0 60px rgba(249, 212, 35, 0.4); }
        .coupon-code { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; color: var(--gold); font-weight: 900; letter-spacing: 1px; display: block; background: rgba(0,0,0,0.4); padding: 15px; margin: 15px 0; border-radius: 18px; border: 2px dashed var(--gold); word-break: break-all; }
        .timer-banner { background: rgba(255, 255, 255, 0.15); padding: 10px; border-radius: 10px; font-size: 0.8rem; color: #fff; margin-top: 10px; }
        .timer-value { color: var(--gold); font-weight: 900; font-family: 'Orbitron'; }
    </style>
</head>
<body>

<div class="card" id="app">
    <div id="start">
        <div style="color: var(--p1); font-weight: 900; margin-bottom: 10px; font-family: 'Orbitron', sans-serif; letter-spacing: 2.5px; font-size: 0.8rem;">â˜… AWAKENING PROJECT â˜…</div>
        <h1>è½‰ç”Ÿæ™ºæ…§é†«ç•Œï¼š<br>åµæ¸¬ä½ çš„æœªä¾†æˆ°ç•¥äººæ ¼</h1>
        <p style="color: var(--text-dim); font-size: 0.95rem; margin-bottom: 2rem;">æ‹¯æ•‘äººé¡çš„ä»»å‹™ï¼Œå…‰é ç†±è¡€æ˜¯ä¸å¤ çš„ã€‚<br>åœ¨æ•¸æ“šè¿·éœ§ä¸­ï¼Œä½ æ˜¯å“ªä¸€ç¨®è¦ºé†’åŠ›é‡ï¼Ÿ</p>
        <button class="option" style="text-align: center; background: var(--p1); color: #000; font-weight: 900; font-size: 1.1rem;" onclick="begin()">å•Ÿå‹•æƒæç¨‹åº</button>
        <div style="font-size: 0.85rem; color: #64748b; margin-top: 20px;">ğŸŸ¢ å·²æœ‰ <span id="p-count" style="font-weight:900;">2,482</span> ä½é«˜ä¸­èè‹±åœ¨ç·šåŒæ­¥</div>
    </div>

    <div id="quiz" class="hidden">
        <div class="progress-bar"><div class="progress-fill" id="bar"></div></div>
        <p id="q-text" style="font-size: 1.15rem; text-align: left; color: var(--text-bright); font-weight: 900; margin-bottom: 1.2rem; min-height: 2.5em; line-height: 1.4;"></p>
        <div id="options"></div>
        <div style="margin-top: 20px;">
            <button onclick="prevStep()" id="prev-btn" style="background:none; border:none; color:#64748b; cursor:pointer; font-size:0.9rem; font-weight:900;">â† è¿”å›ä¸Šä¸€é¡Œ</button>
        </div>
    </div>

    <!-- 3ç§’ä¸è¦å‰‡è·³å‹•é€²åº¦æ¢ -->
    <div id="processing" class="hidden">
        <span class="loading-text">ANALYZING SPECTRUM...</span>
        <div class="long-progress">
            <div class="long-progress-fill" id="long-bar"></div>
        </div>
        <p style="margin-top: 25px; font-size: 1rem; color: var(--p1); font-weight: 700;">æ­£åœ¨æ ¹æ“šæ‚¨çš„æ±ºç­–æ¨¡å‹<br>åŒ¹é…æœªä¾†æˆ°ç•¥äººæ ¼ä½éš</p>
    </div>

    <div id="result" class="hidden">
        <div class="urgent-tag">âš¡ æˆ°ç•¥å¸­æ¬¡åƒ…å‰©ï¼š12 å¸­ âš¡</div>
        <div style="font-size: 0.85rem; color: var(--p1); font-weight: 900; margin-bottom:5px; letter-spacing:1px;">AI è¨ºæ–·å®Œæˆï¼åŒæ­¥ç‡ 98.4%</div>
        <div class="mbti-code" id="res-code"></div>
        <h2 id="res-title" style="color:var(--text-bright); margin-top:0; font-size: 1.5rem; font-weight: 900;"></h2>
        
        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>

        <div class="match-list" id="res-match" style="display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-bottom:15px;"></div>

        <div class="section-box">
            <span class="section-label">ğŸŒŸ ç•°ä¸–ç•Œç”Ÿå­˜æƒ…å¢ƒ</span>
            <div class="section-text" id="res-story"></div>
        </div>

        <div class="section-box" style="border-left-color: var(--p1);">
            <span class="section-label" style="color: var(--p1);">ğŸ¯ æ ¸å¿ƒè·èƒ½èˆ‡è¦ºé†’è£œå¼·</span>
            <div class="section-text" id="res-classroom"></div>
        </div>

        <button class="cta-btn" style="background: var(--gold); color: #000; padding: 1.1rem; margin-top: 20px;" onclick="openCoupon()">
            ğŸ é ˜å–å°ˆå±¬å„ªæƒ ç¢¼ä¸¦æ¶å…ˆå¡ä½
        </button>
        
        <button class="cta-btn" id="retake-btn" style="background:none; color:var(--p1); font-size:1rem; border:none; margin-top:10px; font-weight:900;" onclick="resetTest()">é‡æ–°åµæ¸¬å¤©è³¦ä½éš</button>
    </div>
</div>

<div class="social-toast" id="toast">
    <div class="toast-avatar" id="toast-initial">L</div>
    <div class="toast-body">
        <b id="toast-name" style="color:var(--p1);">æ—åŒå­¸</b> å‰›å®Œæˆäº†é«˜å³°æœƒå¡ä½å ±åï¼
        <div id="toast-time" style="font-size: 11px; color: #94a3b8; margin-top:2px;">5åˆ†é˜å‰ Â· ä¾†è‡ªå°åŒ—å¸‚</div>
    </div>
</div>

<div class="modal-overlay" id="coupon-modal">
    <div class="modal-content">
        <div style="font-size: 2.5rem; margin-bottom: 10px;">ğŸ‘‘</div>
        <h2 style="color:var(--gold); font-size: 1.7rem; font-weight: 900; margin:0; letter-spacing:1px;">é ˜è¢–è³‡æ ¼ç¢ºèªå®Œæˆ</h2>
        <p style="color: #fecaca; font-size: 0.9rem; margin-top: 8px; font-weight:700;">æ‚¨çš„å°ˆå±¬å„ªæƒ ç¢¼å·²æš«æ™‚ä¿ç•™ï¼š</p>
        
        <div class="coupon-code" id="coupon-text">phdcenter_causal888</div>

        <div class="timer-banner">
            <span style="color:var(--gold); font-weight:900; font-size:0.95rem; display:block; margin-bottom:5px;">ğŸš¨ å‰©é¤˜åé¡ï¼š7 ä½</span>
            ç³»çµ±ä¿ç•™æ™‚é–“å‰©é¤˜ï¼š<span class="timer-value" id="timer">24:00:00</span>
        </div>

        <p style="color: #ffffff; font-size: 0.9rem; line-height: 1.5; margin: 15px 0;">
            è«‹å‰å¾€<b>é«˜å³°æœƒå ±åç³»çµ±</b>ï¼Œè¼¸å…¥å„ªæƒ ç¢¼å³å¯æŠ˜æŠµè²»ç”¨ã€‚
        </p>

        <button class="cta-btn" style="background: var(--gold); color: #000; margin-top: 5px;" onclick="copyCoupon()">è¤‡è£½ä»£ç¢¼ä¸¦ç«‹å³å‰å¾€å ±å</button>
        <button onclick="closeModal()" style="border:none; background:transparent; color:rgba(255,255,255,0.6); margin-top:15px; cursor:pointer; font-size:0.9rem; font-weight:700; padding: 10px; display:block; width:100%;">æ”¾æ£„å¸­æ¬¡ä¿ç•™ä¸¦é—œé–‰</button>
    </div>
</div>

<script>
    // --- ç¤¾äº¤èˆ‡è¨ˆæ™‚ç³»çµ± ---
    const names = ["æ—åŒå­¸", "é™³åŒå­¸", "å¼µåŒå­¸", "ç‹åŒå­¸", "æåŒå­¸", "é»ƒåŒå­¸", "å³åŒå­¸", "è”¡åŒå­¸", "é«˜äºŒ é™³åŒå­¸", "é«˜ä¸‰ å¼µåŒå­¸", "å‘¨åŒå­¸", "åŠ‰åŒå­¸", "éƒ­åŒå­¸", "è¨±åŒå­¸", "é«˜ä¸€ è¶™åŒå­¸"];
    const cities = ["å°åŒ—å¸‚", "å°ä¸­å¸‚", "é«˜é›„å¸‚", "å°å—å¸‚", "æ–°ç«¹å¸‚", "æ¡ƒåœ’å¸‚", "å˜‰ç¾©å¸‚", "å½°åŒ–ç¸£", "å±æ±ç¸£", "é›²æ—ç¸£"];
    function showToast() {
        const toast = document.getElementById('toast');
        if(!toast) return;
        const name = names[Math.floor(Math.random() * names.length)];
        const city = cities[Math.floor(Math.random() * cities.length)];
        const randomMin = Math.floor(Math.random() * 55) + 1;
        document.getElementById('toast-name').innerText = name;
        document.getElementById('toast-initial').innerText = name[name.length - 3] || name[0];
        document.getElementById('toast-time').innerText = `${randomMin}åˆ†é˜å‰ Â· ä¾†è‡ª${city}`;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 5000);
    }
    function scheduleNextToast() {
        const intervals = [12000, 30000, 45000, 18000, 25000, 40000];
        setTimeout(() => { showToast(); scheduleNextToast(); }, intervals[Math.floor(Math.random() * intervals.length)]);
    }
    setTimeout(scheduleNextToast, 15000);

    const questions = [
        { q: "çœ‹åˆ°æ•¸æ“šèªªã€åƒæ—©é¤çš„äººæˆç¸¾å¥½ã€ï¼Œä½ çš„ç›´è¦ºåæ‡‰æ˜¯ï¼Ÿ", options: [{ t: "æŒæ¡è¦å¾‹ï¼Œå„ªåŒ–å€‹äººç¿’æ…£æå‡è¡¨ç¾ã€‚", w: { stability: 3, S: 2, J: 2 } }, { t: "è³ªç–‘åŸå› ï¼Œæ¢ç©¶å®¶å¢ƒç­‰èƒŒå¾Œè®Šå› ã€‚", w: { causal: 3, I: 2, T: 2 } }] },
        { q: "çµ„éšŠç«¶è³½æ™‚ï¼Œè‹¥çµ„å“¡æ„è¦‹ç”¢ç”Ÿåš´é‡åˆ†æ­§ï¼Œä½ æœƒå„ªå…ˆï¼Ÿ", options: [{ t: "ä¸»å‹•å”èª¿ï¼Œç¢ºä¿åœ˜éšŠæº–æ™‚å®Œæˆæˆæœã€‚", w: { leadership: 3, E: 2, J: 2 } }, { t: "è…¦åŠ›æ¿€ç›ªï¼Œå¼•å°çµ„å“¡å°‹æ‰¾å‰µæ–°é»å­ã€‚", w: { innovation: 3, N: 2, P: 2 } }] },
        { q: "é¢å°æº–ç¢ºç‡æ¥µé«˜ä½†çœ‹ä¸æ¸…é‹ä½œéç¨‹çš„ AIï¼Œä½ æœƒå„ªå…ˆï¼Ÿ", options: [{ t: "é‡è¦–å®‰å…¨ï¼ŒæŒ‰ç…§æ¨™æº–ç¨‹åºåš´æ ¼æ¸¬è©¦ã€‚", w: { stability: 3, S: 2, J: 2 } }, { t: "é‡æ¸…åŸç†ï¼Œæ·±åº¦æ‹†è§£æ•¸æ“šé‹ä½œé‚è¼¯ã€‚", w: { logic: 3, T: 3, I: 1 } }] },
        { q: "é‡åˆ°ä¸€å€‹é›£è§£çš„ç§‘å±•é¡Œç›®ä¸”ç¾æœ‰æ•™ææ²’ç­”æ¡ˆæ™‚ï¼Œä½ æœƒï¼Ÿ", options: [{ t: "ç´°å¾®è§€å¯Ÿï¼Œå¾å¯¦é©—å·®ç•°ä¸­æ‰¾å‡ºé€£çµã€‚", w: { causal: 3, I: 2, T: 2 } }, { t: "è·¨ç•Œæ€è€ƒï¼Œçµåˆä¸åŒç§‘ç›®çŸ¥è­˜è§£é¡Œã€‚", w: { innovation: 3, N: 2, P: 2 } }] },
        { q: "ç¤¾åœ˜æˆç™¼å€’æ•¸ 24 å°æ™‚ï¼Œè‹¥ç™¼ç¾ç’°ç¯€å¯ä»¥æ›´å¥½ï¼Œä½ æœƒï¼Ÿ", options: [{ t: "ç©©å®šå„ªå…ˆï¼šç·´ç¿’ç¾æœ‰å…§å®¹ç¢ºä¿é›¶å¤±èª¤ã€‚", w: { stability: 3, J: 3, S: 1 } }, { t: "çªç ´å„ªå…ˆï¼šå†’éšªèª¿æ•´äº®é»åŠ›æ±‚è§€çœ¾é©šè‰·ã€‚", w: { leadership: 3, E: 2, P: 2 } }] }
    ];

    let currentStep = 0;
    let userAnswers = new Array(questions.length).fill(null);

    window.begin = () => { 
        document.getElementById('start').classList.add('hidden'); 
        document.getElementById('quiz').classList.remove('hidden'); 
        render(); 
    };

    function render() {
        const q = questions[currentStep];
        document.getElementById('q-text').innerText = `STEP ${currentStep + 1}. ${q.q}`;
        document.getElementById('bar').style.width = ((currentStep) / questions.length) * 100 + "%";
        const box = document.getElementById('options');
        box.innerHTML = '';
        q.options.forEach((o, i) => {
            const b = document.createElement('button');
            b.className = 'option' + (userAnswers[currentStep] === i ? ' selected' : '');
            b.innerText = o.t;
            b.onclick = () => selectOption(i);
            box.appendChild(b);
        });
        document.getElementById('prev-btn').style.visibility = currentStep > 0 ? 'visible' : 'hidden';
    }

    function selectOption(idx) {
        userAnswers[currentStep] = idx;
        render();
        setTimeout(() => { 
            if (currentStep < questions.length - 1) { 
                currentStep++; 
                render(); 
            } else { 
                startProcessing(); 
            } 
        }, 400);
    }

    window.prevStep = () => { if (currentStep > 0) { currentStep--; render(); } }

    function startProcessing() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('processing').classList.remove('hidden');
        const bar = document.getElementById('long-bar');
        let currentProgress = 0;
        const totalTime = 3000; 
        const startTime = Date.now();
        function step() {
            const elapsed = Date.now() - startTime;
            if (elapsed >= totalTime) { bar.style.width = '100%'; setTimeout(showResult, 600); return; }
            const jump = Math.random() > 0.6 ? Math.random() * 35 : Math.random() * 5;
            currentProgress = Math.min(95, currentProgress + jump);
            bar.style.width = currentProgress + '%';
            setTimeout(step, 150 + Math.random() * 350);
        }
        step();
    }

    window.resetTest = () => {
        currentStep = 0;
        userAnswers = new Array(questions.length).fill(null);
        document.getElementById('result').classList.add('hidden');
        document.getElementById('start').classList.remove('hidden');
        document.getElementById('long-bar').style.width = '0%';
        document.getElementById('bar').style.width = '0%';
    };

    function showResult() {
        document.getElementById('processing').classList.add('hidden');
        const resEl = document.getElementById('result');
        resEl.classList.remove('hidden');
        
        let mbtiScores = { E:0, I:0, N:0, S:0, T:0, F:0, J:0, P:0 };
        let dimScores = { innovation:0, logic:0, leadership:0, stability:0, causal:0 };
        
        userAnswers.forEach((ansIdx, qIdx) => {
            if (ansIdx === null || !questions[qIdx] || !questions[qIdx].options[ansIdx]) return;
            const weight = questions[qIdx].options[ansIdx].w;
            for(let k in weight) {
                if(mbtiScores.hasOwnProperty(k)) mbtiScores[k] += weight[k];
                if(dimScores.hasOwnProperty(k)) dimScores[k] += weight[k];
            }
        });

        let code = (mbtiScores.E >= mbtiScores.I ? "E" : "I") + (mbtiScores.N >= mbtiScores.S ? "N" : "S") + (mbtiScores.T >= mbtiScores.F ? "T" : "F") + (mbtiScores.J >= mbtiScores.P ? "J" : "P");
        document.getElementById('res-code').innerText = code;

        const resultsMap = {
            "ENTJ": { t: "AI æˆ°ç•¥ç¸½æŒ‡æ®", s: "ä½ æ˜¯å¤©ç”Ÿçš„æ±ºç­–é ˜è¢–ã€‚åœ¨è¤‡é›œçš„æ•¸æ“šè¿·éœ§ä¸­ï¼Œä½ èƒ½ä¸€çœ¼çœ‹ç©¿é€šå¾€è§£è—¥çš„æœ€çŸ­è·¯å¾‘ã€‚ä½ çš„å­˜åœ¨æ˜¯åœ˜éšŠåœ¨å•†æˆ°èˆ‡ç§‘ç ”ä¸­çš„å®šæµ·ç¥é‡ã€‚", r: "<b>ä½ çš„æˆ°ä½ï¼š</b> åœ˜éšŠä¸­çš„<b>ç­–ç•¥é ˜èˆªå“¡</b>ã€‚<br><b>ç‡ŸéšŠå¼·åŒ–ï¼š</b> æœ¬æ¬¡èª²ç¨‹å°‡ç‚ºä½ è§£é–<b>ã€é†«è—¥ AI æˆ°ç•¥åŠ é€Ÿå¼•æ“ã€</b>ã€‚" },
            "INTJ": { t: "å› æœçœŸç›¸å»ºç¯‰å¸«", s: "ä½ æ“æœ‰æ¥µå¼·çš„å…¨å±€è¦–é‡èˆ‡é è¦‹åŠ›ã€‚ä½ è¦–æ•¸æ“šç‚ºè—åœ–ï¼Œåˆ©ç”¨é‚è¼¯èˆ‡ç›´è¦ºæ§‹å»ºå®Œç¾çš„é–‹ç™¼é«”ç³»ï¼Œæ˜¯åœ˜éšŠä¸­æœ€æ·±ä¸å¯æ¸¬çš„å¹•å¾Œæ¨æ‰‹ã€‚", r: "<b>ä½ çš„æˆ°ä½ï¼š</b> åœ˜éšŠä¸­çš„<b>é¦–å¸­æ¶æ§‹å¸«</b>ã€‚<br><b>ç‡ŸéšŠå¼·åŒ–ï¼š</b> æˆ‘å€‘å°‡æä¾›<b>ã€å¤§æ•¸æ“šå› æœåˆ†ææŠ€è¡“ã€</b>èª²ç¨‹ã€‚" },
            "INTP": { t: "æ•¸æ“šåµæ¢è§£æå®˜", s: "ä½ æ‹’çµ•ç›²å¾ã€‚å°ä½ è€Œè¨€ï¼Œæ•¸æ“šèƒŒå¾Œçš„é‹ä½œè¦å¾‹æ‰æ˜¯çœŸç›¸ã€‚ä½ å†·éœæ‹†è§£æ¯ä¸€é … AI é æ¸¬ï¼Œæ˜¯ç¢ºä¿è¨ˆç•«ä¸è¢«å‡è±¡èª¤å°çš„æœ€å¼·å®ˆé–€å“¡ã€‚", r: "<b>ä½ çš„æˆ°ä½ï¼š</b> åœ˜éšŠä¸­çš„<b>æ·±åº¦è§£æå®˜</b>ã€‚<br><b>ç‡ŸéšŠå¼·åŒ–ï¼š</b> æˆ‘å€‘å°‡æä¾›<b>ã€å› æœæ¨è«–å¯¦æˆ°æ‰‹å†Šã€</b>ã€‚" },
            "ENFP": { t: "è·¨ç•Œå‰µæ–°é è¨€å®¶", s: "ä½ æ˜¯åœ˜éšŠçš„éˆæ„Ÿæºæ³‰ã€‚ä½ æ“…é•·ç™¼ç¾æ•¸æ“šä¸­éš±è—çš„æ„ç¾©èˆ‡æ©Ÿæœƒï¼Œèƒ½å°‡å†·å†°å†°çš„ç§‘å­¸ç™¼ç¾è½‰åŒ–ç‚ºæ”¹è®Šä¸–ç•Œçš„é¡˜æ™¯ã€‚", r: "<b>ä½ çš„æˆ°ä½ï¼š</b> åœ˜éšŠä¸­çš„<b>å‰µæ–°æ¨å»£è€…</b>ã€‚<br><b>ç‡ŸéšŠå¼·åŒ–ï¼š</b> å­¸ç¿’å¦‚ä½•å°‡<b>ã€AI æ•¸æ“šè½‰åŒ–ç‚ºæˆ°ç•¥èªªæœåŠ›ã€</b>ã€‚" }
        };

        const f = resultsMap[code] || { 
            t: "è¦ºé†’è¨ˆç•«å…ˆé‹’", 
            s: "ä½ æ˜¯å…¨èƒ½å‹çš„æˆ°ç•¥äººæ‰ã€‚åœ¨ç®—åŠ›èˆ‡æ·±åº¦é‚è¼¯ä¹‹é–“ï¼Œä½ æŒæ¡äº†å®Œç¾çš„å¹³è¡¡ã€‚é€™ç¨®å¤šå…ƒè¦–è§’åœ¨æœªä¾†é†«ç•Œæ˜¯æ¥µå…¶çç¨€ä¸”è¢«é«˜åº¦æ¸´æ±‚çš„è³‡è³ªã€‚", 
            r: "<b>ä½ çš„æˆ°ä½ï¼š</b> åœ˜éšŠä¸­çš„<b>æŠ€è¡“å”èª¿å®˜</b>ã€‚<br><b>ç‡ŸéšŠå¼·åŒ–ï¼š</b> æœ¬æ¬¡ç‡ŸéšŠå°‡æä¾›å…¨æ–¹ä½çš„<b>ã€è—¥ç‰©é–‹ç™¼å¤§å¸«åœ°åœ–ã€</b>ã€‚" 
        };

        document.getElementById('res-title').innerText = f.t;
        document.getElementById('res-story').innerHTML = f.s;
        document.getElementById('res-classroom').innerHTML = f.r;

        requestAnimationFrame(() => {
            const normalize = (val) => Math.min(95, Math.max(48, val * 12)); 
            drawRadar({
                innovation: normalize(dimScores.innovation), 
                logic: normalize(dimScores.logic), 
                leadership: normalize(dimScores.leadership), 
                stability: normalize(dimScores.stability), 
                causal: normalize(dimScores.causal)
            });

            const matchBox = document.getElementById('res-match');
            let mHTML = `<div class="match-tag">æ ¸å¿ƒåŸå‹: <b>${code} 98.4%</b></div>`;
            ["INTJ", "ENTJ", "INTP", "ENFP"].filter(t => t !== code).slice(0,2).forEach(t => { mHTML += `<div class="match-tag">${t} <b>${Math.floor(Math.random()*15+70)}%</b></div>`; });
            matchBox.innerHTML = mHTML;
        });
    }

    // --- äº”è§’åœ–å„ªåŒ–ï¼šè‡ªé©æ‡‰å¯¬åº¦èˆ‡å­—é«”é˜²åˆ‡é‚Š ---
    function drawRadar(data) {
        const canvas = document.getElementById('radarChart');
        const ctx = canvas.getContext('2d');
        const container = canvas.parentElement;
        const containerWidth = container.offsetWidth;
        const size = Math.min(containerWidth, 360);
        
        const dpr = window.devicePixelRatio || 2;
        canvas.width = size * dpr; 
        canvas.height = size * dpr;
        canvas.style.width = size + 'px'; 
        canvas.style.height = size + 'px';
        ctx.scale(dpr, dpr);

        const centerX = size / 2, centerY = size / 2;
        // æ‰‹æ©Ÿç‰ˆè‡ªå‹•ç¸®å°åœ–å½¢ï¼Œç•™æ›´å¤šç©ºé–“çµ¦å­—é«”
        const radius = size * (size < 340 ? 0.23 : 0.27); 
        const labels = ["å‰µæ–°ç›´è¦º", "é‚è¼¯æ¨ç†", "ç¤¾äº¤é ˜å°", "åŸ·è¡Œç©©å®š", "å› æœæ´å¯Ÿ"];
        const values = [data.innovation, data.logic, data.leadership, data.stability, data.causal];

        ctx.clearRect(0, 0, size, size);
        ctx.strokeStyle = "rgba(0, 242, 254, 0.3)"; ctx.lineWidth = 1;
        for (let j = 1; j <= 5; j++) {
            ctx.beginPath();
            const r = (radius / 5) * j;
            for (let i = 0; i < 5; i++) {
                const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
                ctx.lineTo(centerX + r * Math.cos(a), centerY + r * Math.sin(a));
            }
            ctx.closePath(); ctx.stroke();
        }
        ctx.beginPath();
        for (let i = 0; i < 5; i++) {
            const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
            const r = (values[i] / 100) * radius;
            ctx.lineTo(centerX + r * Math.cos(a), centerY + r * Math.sin(a));
        }
        ctx.closePath(); ctx.fillStyle = "rgba(0, 242, 254, 0.45)"; ctx.fill(); ctx.strokeStyle = "var(--p1)"; ctx.lineWidth = 3; ctx.stroke();
        
        const fontSize = size < 340 ? 12 : 14;
        ctx.fillStyle = "#ffffff"; ctx.font = `bold ${fontSize}px 'Noto Sans TC'`;
        for (let i = 0; i < 5; i++) {
            const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
            const textDist = radius + (size < 340 ? 18 : 24); 
            const tx = centerX + textDist * Math.cos(a);
            const ty = centerY + textDist * Math.sin(a);
            
            // æ‰‹æ©Ÿç‰ˆå‹•æ…‹å°é½Šä¿®æ­£
            if (i === 0) { ctx.textAlign = "center"; ctx.textBaseline = "bottom"; }
            else if (i === 1) { ctx.textAlign = "left"; ctx.textBaseline = "middle"; }
            else if (i === 2) { ctx.textAlign = "left"; ctx.textBaseline = "top"; }
            else if (i === 3) { ctx.textAlign = "right"; ctx.textBaseline = "top"; }
            else if (i === 4) { ctx.textAlign = "right"; ctx.textBaseline = "middle"; }
            ctx.fillText(labels[i], tx, ty);
        }
    }

    // --- å€’æ•¸è¨ˆæ™‚æ°¸ä¹…é–å®šæ ¸å¿ƒé‚è¼¯ ---
    const TOTAL_TIME = 86400; 
    let timerInterval = null;

    function startTimer() {
        if (timerInterval) return;
        
        let targetTimestamp = localStorage.getItem('awakening_expiry_timestamp');
        if (!targetTimestamp) {
            targetTimestamp = Date.now() + (TOTAL_TIME * 1000);
            localStorage.setItem('awakening_expiry_timestamp', targetTimestamp);
        } else {
            targetTimestamp = parseInt(targetTimestamp);
        }
        
        const tick = () => {
            const now = Date.now();
            const remaining = Math.floor((targetTimestamp - now) / 1000);
            const el = document.getElementById('timer');
            
            if (remaining <= 0) { 
                if(el) el.innerText = "00:00:00"; 
                clearInterval(timerInterval); 
                return; 
            }
            
            const h = Math.floor(remaining / 3600);
            const m = Math.floor((remaining % 3600) / 60);
            const s = remaining % 60;
            
            if(el) el.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        };

        tick(); 
        timerInterval = setInterval(tick, 1000);
    }

    window.openCoupon = () => { document.getElementById('coupon-modal').style.display = 'flex'; startTimer(); };
    window.closeModal = () => { document.getElementById('coupon-modal').style.display = 'none'; };
    window.copyCoupon = () => {
        const dummy = document.createElement("textarea"); document.body.appendChild(dummy);
        dummy.value = "phdcenter_causal888"; dummy.select(); document.execCommand("copy"); document.body.removeChild(dummy);
        alert("ä»£ç¢¼å·²è¤‡è£½ï¼å³å°‡å‰å¾€å ±åç³»çµ±..."); window.open('https://www.phdcenter.org.tw/2026-ai-camp/', '_blank');
    };
</script>
</body>
</html>
