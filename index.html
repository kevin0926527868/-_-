<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å› æœé­”æ³•å­¸é™¢ï¼šè¦ºé†’è€…äººæ ¼è©•å®š</title>
    <!-- å¼•å…¥ç¥ç¥•å­¸æ„Ÿå­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Noto+Sans+TC:wght@400;700;900&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --primary: #427567;         /* ä¸»è‰²ï¼šæ¾å¶ºç¶  */
            --primary-dark: #1a261f;    /* æ£®æ—æš—éƒ¨ */
            --primary-light: #88b4a9;   /* è‹”è˜šç¶  */
            --accent-warm: #e5c07b;     /* æš–é¦™æª³é‡‘ */
            --bg-deep: #0c110e;         /* æ£®æ—æ·±å¤œåŸºèª¿ */
            --text-bright: #fdf6e3;     /* è±¡ç‰™ç™½ */
            --text-soft: #b1b59c;       /* ç¾Šçš®ç´™ç°ç¶  */
            --magic-glow: rgba(229, 192, 123, 0.3); /* æš–é‡‘ç™¼å…‰ */
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body { 
            font-family: 'Quicksand', 'Noto Sans TC', sans-serif; 
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(66, 117, 103, 0.3) 0%, transparent 75%),
                radial-gradient(circle at 100% 100%, rgba(229, 192, 123, 0.05) 0%, transparent 40%),
                url('https://www.transparenttextures.com/patterns/dark-wood.png');
            background-attachment: fixed;
            color: var(--text-bright); 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start; 
            min-height: 100vh;
            padding: 15px 0;
            overflow-x: hidden;
            line-height: 1.5;
        }

        .card { 
            width: 94%; 
            max-width: 480px; 
            background: rgba(26, 38, 31, 0.98); 
            padding: 2.5rem 1.5rem; 
            border-radius: 4px; 
            border: 1px solid var(--primary);
            box-shadow: 0 40px 120px rgba(0, 0, 0, 1), 0 0 30px rgba(66, 117, 103, 0.1); 
            text-align: center; 
            position: relative;
            backdrop-filter: blur(25px);
            margin: auto;
        }

        .card::before {
            content: ""; position: absolute; top: 12px; left: 12px; width: 35px; height: 35px;
            border-top: 2px solid var(--accent-warm); border-left: 2px solid var(--accent-warm);
            opacity: 0.8;
        }
        .card::after {
            content: ""; position: absolute; bottom: 12px; right: 12px; width: 35px; height: 35px;
            border-bottom: 2px solid var(--accent-warm); border-right: 2px solid var(--accent-warm);
            opacity: 0.8;
        }

        h1 { 
            font-size: clamp(1.2rem, 5vw, 1.45rem); 
            color: var(--accent-warm); 
            margin-bottom: 1.5rem; 
            font-family: 'Cinzel', 'Noto Sans TC', serif;
            font-weight: 900;
            line-height: 1.4;
            text-shadow: 0 4px 10px rgba(0,0,0,0.9);
            letter-spacing: 1px;
        }

        .mbti-code { 
            font-size: clamp(2.5rem, 12vw, 4rem); 
            font-weight: 900; 
            color: var(--accent-warm); 
            margin: 10px 0; 
            font-family: 'Cinzel', serif; 
            text-shadow: 0 0 30px var(--magic-glow);
            letter-spacing: 8px;
        }

        #q-text-container {
            min-height: 110px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .option { 
            display: block; 
            width: 100%; 
            padding: 1.1rem 1.2rem; 
            margin: 12px 0; 
            background: rgba(255, 255, 255, 0.05); 
            border: 1.5px solid var(--primary); 
            border-radius: 4px;
            color: var(--text-bright); 
            text-align: left; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            font-size: 0.95rem; 
            font-weight: 700;
            white-space: normal; 
            word-wrap: break-word;
            overflow: visible;
            text-overflow: clip;
            line-height: 1.5;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
        }

        .option:hover, .option:active { 
            background: var(--primary); 
            color: #fff;
            border-color: var(--accent-warm);
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(66, 117, 103, 0.4);
        }

        .option.selected { 
            background: rgba(229, 192, 123, 0.2); 
            border-color: var(--accent-warm);
            color: var(--accent-warm);
            box-shadow: 0 0 20px var(--magic-glow);
        }

        .progress-bar { width: 100%; height: 3px; background: rgba(0,0,0,0.6); margin-bottom: 1.5rem; border-radius: 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent-warm)); width: 0%; transition: 0.8s; }

        .hidden { display: none !important; }

        .section-box { 
            width: 100%;
            text-align: left; 
            background: rgba(0, 0, 0, 0.4); 
            padding: 1.2rem; 
            border-radius: 2px;
            border-left: 3px solid var(--primary);
            margin-top: 15px; 
        }
        .section-label { 
            color: var(--accent-warm); 
            font-size: 0.8rem; 
            font-weight: 900; 
            margin-bottom: 10px; 
            display: block;
            font-family: 'Cinzel', sans-serif;
            letter-spacing: 2px;
        }

        .cta-btn { 
            background: var(--accent-warm); 
            color: var(--primary-dark); 
            border: none; 
            padding: 1.2rem; 
            font-size: 1.1rem; 
            font-weight: 900; 
            width: 100%; 
            cursor: pointer; 
            margin-top: 25px; 
            transition: 0.3s;
            border-radius: 4px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        .cta-btn:hover { background: #fff; transform: translateY(-3px); }

        .magic-fade {
            animation: magicFade 3.5s ease-in-out infinite;
        }
        @keyframes magicFade {
            0%, 100% { opacity: 0.2; transform: scale(0.98); color: var(--text-soft); }
            50% { opacity: 1; transform: scale(1.02); text-shadow: 0 0 15px var(--accent-warm); color: var(--accent-warm); }
        }

        /* ä¿®æ­£å¾Œçš„æ¥µç°¡å·¦ä¸‹è§’é€šçŸ¥ - æ›´å°ä¸”ä¸å¹²æ“¾ */
        .toast {
            position: fixed; bottom: 10px; left: 10px; 
            background: rgba(26, 36, 34, 0.95); 
            border: 1px solid var(--primary);
            padding: 6px 12px; border-radius: 4px; display: flex; align-items: center;
            gap: 8px; z-index: 5000; transition: 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            max-width: 200px;
            transform: translateX(-150%);
        }
        .toast.show { transform: translateX(0); }
        .toast-initial { 
            width: 25px; height: 25px; background: var(--primary); color: #fff; 
            border-radius: 2px; display: flex; align-items: center; justify-content: center; 
            font-weight: 900; flex-shrink: 0; font-size: 0.7rem;
        }

        .chart-container { width: 100%; display: flex; justify-content: center; margin: 15px 0; }
        #radarChart { max-width: 100%; height: auto; }
        
        .story-text { font-size: 0.95rem; line-height: 1.7; color: var(--text-soft); text-align: left; margin-bottom: 2rem; }
        .match-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; width: 100%; }
        .match-bar-bg { flex-grow: 1; height: 6px; background: rgba(0,0,0,0.7); border-radius: 3px; overflow: hidden; }
        .match-bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--primary-light)); width: 0%; transition: 2s cubic-bezier(0.2, 1, 0.3, 1); }

        .coupon-box {
            background: rgba(0, 0, 0, 0.6); 
            padding: 15px 10px; 
            border: 1px dashed var(--accent-warm); 
            margin: 15px 0; 
            font-family: 'Cinzel', serif; 
            font-weight: 900; 
            color: var(--accent-warm); 
            letter-spacing: 3px; 
            font-size: clamp(1rem, 4.5vw, 1.3rem); 
            box-shadow: inset 0 0 30px rgba(0,0,0,0.9);
            word-break: break-all;
            overflow-wrap: break-word;
            line-height: 1.4;
            max-width: 100%;
        }

        .urgent-pulse { animation: pulse 2s infinite; color: var(--accent-warm); font-weight: 900; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="card" id="app">
    <!-- é–‹å§‹é é¢ -->
    <div id="start">
        <div style="color: var(--primary-light); font-weight: 900; margin-bottom: 12px; font-family: 'Cinzel'; letter-spacing: 6px; font-size: 0.8rem; opacity: 0.8;">âœ§ THE CAUSAL MAGIC âœ§</div>
        <h1>è½‰ç”Ÿè¢« AI ä¸»å®°çš„ä¸–ç•Œï¼š<br>ä½ æ˜¯å”¯ä¸€çš„è¦ºé†’è€…å—ï¼Ÿ</h1>
        
        <div class="story-text">
            ç•¶ä½ çœé–‹çœ¼ï¼Œä¸–ç•Œå·²è®Šå¾—å¤æ€ªã€‚<br>
            äººå€‘å–ªå¤±æ€è€ƒï¼Œå…¨ç„¶è½å‘½æ–¼ AIã€‚<br>
            ã€ŒAI èªªåƒè¶Šå¤šå·§å…‹åŠ›ï¼Œå¾—çæ©Ÿç‡è¶Šé«˜ã€‚ã€<br>
            ã€ŒAI èªªæ”¾æ£„åŠªåŠ›ï¼Œå› ç‚ºè®€æ›¸æœƒå°è‡´è‡ªæ®ºç‡ã€‚ã€<br><br>
            åœ¨ä¸€é“è¿·éœ§çš„é‡‘å…‰ä¸­ï¼Œä½ æ¨é–‹äº†<b>ã€Œå› æœé­”æ³•å­¸é™¢ã€</b>çš„å¤§é–€ã€‚<br>
            äº”ä½å°å¸«åœ¨å¤é›…çš„æœ¨å±‹ä¸­é©šå–œåœ°ç›¯è‘—ä½ ï¼š<br>
            <div class="magic-fade" style="text-align: center; margin-top: 10px; font-size: 1.1rem; font-weight: 900;">ã€Œå’¦ï¼Œä½ èƒ½çœ‹è¦‹æˆ‘å€‘å—ï¼Ÿã€</div><br>
            ä½ ï¼Œå°±æ˜¯åƒ…å­˜æœ‰è‡ªæˆ‘æ„è­˜çš„äººé¡ã€‚<br>
            æº–å‚™å¥½å­¸ç¿’å› æœé­”æ³•ï¼Œæ‹¯æ•‘äººé¡äº†å—ï¼Ÿ
        </div>

        <button class="cta-btn" onclick="begin()">å•Ÿå‹•äººæ ¼é‘‘å®šè©¦ç…‰</button>
        <div style="font-size: 0.75rem; color: var(--text-soft); margin-top: 30px; letter-spacing: 1px; font-weight: 700; opacity: 0.7;">
            ç›®å‰å·²æœ‰ 5,482 ä½è¦ºé†’å‹‡è€…é€šéè©•å®š âœ§
        </div>
    </div>

    <!-- æ¸¬é©—é é¢ -->
    <div id="quiz" class="hidden">
        <div class="progress-bar"><div class="progress-fill" id="bar"></div></div>
        <div id="q-text-container">
            <div id="q-text"></div>
        </div>
        <div id="options" style="width: 100%;"></div>
        <div style="margin-top: 20px;">
            <button onclick="prevStep()" id="prev-btn" style="background:none; border:none; color:var(--text-soft); cursor:pointer; font-size:0.8rem; font-weight:700;">â† è¿”å›ä¸Šä¸€å€‹æ±ºç­–é»</button>
        </div>
    </div>

    <!-- åˆ†æä¸­é é¢ -->
    <div id="processing" class="hidden">
        <div style="margin: 50px 0; width: 100%;">
            <div class="mbti-code" style="font-size: 1.2rem; margin-bottom: 25px; color: var(--accent-warm);">å› æœç·šç´¢ç·¨ç¹”ä¸­...</div>
            <div style="height: 6px; background: rgba(0,0,0,0.7); width: 100%; position: relative; border-radius: 4px; overflow: hidden;">
                <div id="long-bar" style="position: absolute; height: 100%; background: var(--accent-warm); width: 0%; transition: 0.4s;"></div>
            </div>
            <p style="margin-top: 35px; font-size: 0.9rem; color: var(--primary-light); letter-spacing: 2px; font-weight: 700; line-height: 1.8;">
                æ­£åœ¨å¾æ‚¨çš„æ±ºç­–å°è¨˜ä¸­<br>æç…‰å› æœé­”æ³•é »è­œ...
            </p>
        </div>
    </div>

    <!-- çµæœé é¢ -->
    <div id="result" class="hidden">
        <div style="color: var(--primary-light); font-size: 0.8rem; font-weight: 900; letter-spacing: 3px; margin-bottom: 5px;">âœ§ çœŸç›¸é¡¯ç¾ï¼šè¦ºé†’å…±é³´åº¦ 99.8% âœ§</div>
        <div class="mbti-code" id="res-code"></div>
        <h2 id="res-title" style="color:var(--accent-warm); margin-bottom: 12px; font-size: 1.5rem; font-weight: 900; font-family: 'Cinzel', serif;"></h2>
        
        <div class="chart-container">
            <canvas id="radarChart"></canvas>
        </div>

        <!-- å„ªæƒ ç¢¼å€å¡Šï¼šç›´æ¥é¡¯ç¤º -->
        <div class="section-box" style="border-left-color: var(--accent-warm); text-align: center;">
            <p style="font-size: 0.85rem; color: var(--text-bright); margin-bottom: 5px;">æ‚¨çš„ç‰¹è³ªå·²ç²å°å¸«èªèªï¼Œä»£ç¢¼å·²é–å®šï¼š</p>
            <div class="coupon-box">phdcenter_causal888</div>
            <div id="timer-result" style="color: var(--text-bright); font-family: 'Quicksand', sans-serif; font-weight: 900; font-size: 1.3rem; margin-bottom: 5px; letter-spacing: 3px;">24:00:00</div>
            <p class="urgent-pulse" style="font-size: 0.8rem; margin: 0;">âš ï¸ å› æœé­”æ³•å­¸é™¢ç›®å‰åƒ…å‰© 3 å€‹å…¥å­¸åé¡</p>
        </div>

        <div class="section-box">
            <span class="section-label">âœ¦ è¦ºé†’ç‰¹è³ªç›¸ä¼¼åº¦ âœ¦</span>
            <div id="match-spectrum" style="width: 100%;"></div>
        </div>

        <div class="section-box">
            <span class="section-label">âœ¦ 2099 è¦ºé†’è·èƒ½æè¿° âœ¦</span>
            <div id="res-story" style="font-size: 0.9rem; line-height: 1.7; color: var(--text-bright);"></div>
        </div>

        <div class="section-box" style="border-left-color: var(--accent-warm);">
            <span class="section-label" style="color: var(--accent-warm);">âœ¦ æ–°è—¥é–‹ç™¼æŠ€èƒ½è£œå¼·å»ºè­° âœ¦</span>
            <div id="res-growth" style="font-size: 0.9rem; line-height: 1.7; color: var(--text-bright);"></div>
        </div>

        <a href="https://www.phdcenter.org.tw/2026-ai-camp/" target="_blank" class="cta-btn" onclick="copyCoupon()">ğŸ”¥ æœ€å¾Œä¸€æ‰¹å„ªæƒ åé¡ï½œç«‹å³å¡ä½</a>
        
        <button onclick="resetTest()" style="background:none; border:none; color:var(--text-soft); margin-top:25px; cursor:pointer; font-size:0.85rem; font-weight:700;">é‡æ–°æ„ŸçŸ¥è¦ºé†’ä½éš</button>
    </div>
</div>

<div class="toast" id="toast">
    <div class="toast-initial" id="toast-initial">é™³</div>
    <div style="font-size: 0.65rem; color: #fff; line-height: 1.3; font-weight: 700;">
        <span id="toast-content">é™³åŒå­¸ å·²ç²å¾—å…¥å­¸è³‡æ ¼</span>
        <div style="font-size: 0.55rem; color: var(--text-soft); font-weight: 400;" id="toast-sub">å‰›å‰› Â· ä¾†è‡ªæ–°åŒ—å¸‚</div>
    </div>
</div>

<script>
    const questions = [
        { q: "æœ‹å‹èªªï¼šã€AI é æ¸¬åƒå·§å…‹åŠ›è¶Šå¤šï¼Œè«¾è²çˆ¾çæ©Ÿç‡è¶Šé«˜ï¼ã€ä½ çš„åæ‡‰ï¼Ÿ", options: [{ t: "è§€å¯Ÿ AI çš„é‚è¼¯ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½é€éè¦å¾‹è®Šå¼·ã€‚", w: { stability: 3, S: 2, J: 2 } }, { t: "é€™åªæ˜¯è³‡æ–™æ¹Šå·§å§ï¼Ÿé€™ä¸–ç•Œç˜‹äº†ï¼Œæˆ‘è¦æ‰¾å‡ºå› æœçœŸç›¸ã€‚", w: { causal: 3, I: 2, T: 2 } }] },
        { q: "é–‹ç™¼ã€è¦ºé†’æ–°è—¥ã€é‡åˆ°ç“¶é ¸ï¼Œå°å¸«å€‘æ„è¦‹ç”¢ç”Ÿåš´é‡åˆ†æ­§ï¼Œä½ æœƒï¼Ÿ", options: [{ t: "ä¸»å‹•ç«™å‡ºä¾†å”èª¿æ•´åˆï¼Œç¢ºä¿è¨ˆç•«èƒ½æº–æ™‚æ¨é€²ã€‚", w: { leadership: 3, E: 2, J: 2 } }, { t: "æ€è€ƒå¹³è¡Œå®‡å®™çš„å¯èƒ½æ€§ï¼Œçœ‹çœ‹æœ‰æ²’æœ‰å‰µæ–°çš„é–‹ç™¼é»ã€‚", w: { innovation: 3, N: 2, P: 2 } }] },
        { q: "æœ‰ä¸€å€‹è¶…æº–ä½†éç¨‹ä¸æ˜çš„ã€æ–°è—¥ AI é æ¸¬ç¥ç®—ã€ï¼Œä½ æœƒï¼Ÿ", options: [{ t: "ç›´æ¥æ¡ç”¨ï¼Œçˆ­å–æ™‚é–“æ‹¯æ•‘æ›´å¤šå³å°‡å–ªå¤±æ€è€ƒèƒ½åŠ›çš„äººã€‚", w: { stability: 3, J: 3, S: 1 } }, { t: "ç ”ç©¶é‹ä½œé‚è¼¯ï¼Œè¬ä¸€ AI è¢«æ´—è…¦äº†å°è‡´åå·®æ€éº¼è¾¦ï¼Ÿ", w: { logic: 3, T: 3, I: 1 } }] },
        { q: "åœ¨ 2099 å¹´çš„æœ‰é™è³‡æºä¸‹ï¼Œä½ çš„æ–°è—¥é–‹ç™¼æ–¹é‡æ˜¯ï¼Ÿ", options: [{ t: "ç²¾ç¢ºé‹ç”¨çœŸå¯¦ä¸–ç•Œè³‡æ–™ï¼ˆRWEï¼‰ï¼Œç©©ç´®ç©©æ‰“å®Œæˆç ”ç©¶ã€‚", w: { causal: 3, I: 2, T: 2 } }, { t: "å°‹æ‰¾ AI éæ¿¾å·¥å…·ï¼Œå¿«é€Ÿæ‰¾å‡ºæœ€æœ‰æ½›åŠ›çš„è—¥ç‰©åˆ†å­ã€‚", w: { innovation: 3, N: 2, P: 2 } }] },
        { q: "é¢å°å„åœ‹é ˜è¢–ï¼Œä½ èªç‚ºèªªæœä»–å€‘é–‹ç™¼ã€è¦ºé†’è—¥ç‰©ã€çš„é—œéµæ˜¯ï¼Ÿ", options: [{ t: "å±•ç¾å¼·å¤§çš„è³‡æ–™çµ„ç¹”åŠ›èˆ‡å•†æ¥­æ™ºèƒ½ï¼ˆBIï¼‰ã€‚", w: { leadership: 3, E: 3, J: 1 } }, { t: "é‹ç”¨å› æœæ¨è«–ï¼ˆCIï¼‰æ­éœ² AI ä¸»å®°ä¸‹çš„æ€ç¶­çœŸç›¸ã€‚", w: { innovation: 3, N: 3, P: 1 } }] }
    ];

    let currentStep = 0;
    let userAnswers = new Array(questions.length).fill(null);
    let globalEndTime = null;
    let timerItv = null;

    window.begin = () => {
        document.getElementById('start').classList.add('hidden');
        document.getElementById('quiz').classList.remove('hidden');
        render();
    };

    function render() {
        const q = questions[currentStep];
        const qTextEl = document.getElementById('q-text');
        
        qTextEl.innerHTML = `
            <div style="font-size: 0.85rem; color: var(--accent-warm); font-family: 'Cinzel'; margin-bottom: 15px; letter-spacing: 3px; font-weight: 700;">
                âœ§ é­”æ³•è©¦ç…‰ ${currentStep + 1} / 5 âœ§
            </div>
            <div style="line-height: 1.6; font-size: 1.15rem; color: #fff; font-weight: 900; text-shadow: 1px 1px 2px #000;">${q.q}</div>
        `;

        document.getElementById('bar').style.width = ((currentStep + 1) / questions.length) * 100 + "%";
        const box = document.getElementById('options');
        box.innerHTML = '';
        q.options.forEach((o, i) => {
            const b = document.createElement('button');
            b.className = 'option' + (userAnswers[currentStep] === i ? ' selected' : '');
            b.innerText = o.t;
            b.onclick = () => selectOption(i);
            box.appendChild(b);
        });
    }

    function selectOption(idx) {
        userAnswers[currentStep] = idx;
        render();
        setTimeout(() => {
            if (currentStep < questions.length - 1) {
                currentStep++;
                render();
            } else {
                startProcessing();
            }
        }, 300);
    }

    window.prevStep = () => { 
        if (currentStep > 0) { currentStep--; render(); } 
        else { document.getElementById('quiz').classList.add('hidden'); document.getElementById('start').classList.remove('hidden'); }
    }

    function startProcessing() {
        document.getElementById('quiz').classList.add('hidden');
        document.getElementById('processing').classList.remove('hidden');
        let p = 0;
        const bar = document.getElementById('long-bar');
        const itv = setInterval(() => {
            p += Math.random() * 18;
            if (p >= 100) { p = 100; clearInterval(itv); setTimeout(showResult, 600); }
            bar.style.width = p + '%';
        }, 180);
    }

    const mbtiMap = {
        "ENTJ": { 
            t: "è¦ºé†’æˆ°ç•¥å°å¸«", 
            s: "ä½ æ˜¯å­¸é™¢ä¸­æœ€æœ‰å¨æœ›çš„é ˜å°è€…ã€‚ä½†åœ¨é€™å€‹ AI å‡è±¡æ©«è¡Œçš„ä¸–ç•Œï¼Œä½ çš„æœæ–·æœ‰æ™‚æœƒè®“ä½ è½å…¥å½è£çš„å› æœé™·é˜±ä¸­ã€‚", 
            g: "ä½ éœ€è¦ä¿®è¡Œã€å› æœæ¨è«–åŠ› (CI)ã€ã€‚èª²ç¨‹å°‡æ•™ä½ å¦‚ä½•è­˜ç ´è³‡æ–™ä¸­çš„æ··é›œå› å­ï¼Œè®“ä½ å¸¶é ˜äººé¡é–‹ç™¼è—¥ç‰©æ™‚ï¼Œæ¯ä¸€å¼µæ±ºç­–ç‰Œéƒ½æ‰“åœ¨çœŸç›¸ä¸Šã€‚"
        },
        "INTJ": { 
            t: "å› æœè—åœ–å¤§é­”å°", 
            s: "ä½ çš„æ€ç¶­æ·±ä¸å¯æ¸¬ï¼Œèƒ½åœ¨è…¦ä¸­æ¨¡æ“¬å¹³è¡Œå®‡å®™ã€‚ä½†è¦æŠŠé­”æ³•å¸¶å…¥ç¾å¯¦ï¼Œé‚„éœ€è¦æŒæ¡çœŸå¯¦ä¸–ç•Œçš„è³‡æ–™ã€‚", 
            g: "ä½ éœ€è¦å­¸ç¿’ã€AI æ‡‰ç”¨èˆ‡çœŸå¯¦ä¸–ç•Œè³‡æ–™ã€ã€‚å¯¦æˆ°èª²ç¨‹å°‡æ•™ä½ å¦‚ä½•å°‡é«˜ç¶­åº¦çš„é‚è¼¯è—åœ–è½‰åŒ–ç‚ºæ‹¯æ•‘å…¨äººé¡çš„è‡¨åºŠæ–°è—¥æˆæœã€‚"
        },
        "INTP": { 
            t: "éˆé­‚çœŸç›¸è§£æå®˜", 
            s: "ä½ å¤©ç”Ÿå°±èƒ½ç ”ç©¶ AI çš„é‹ä½œé‚è¼¯ï¼Œè­˜ç ´å‡è±¡ï¼Œæ˜¯å­¸é™¢æœ€å¼·çš„è³‡æ–™é˜²ç·šã€‚ä½†è¦èªªæœé ˜è¢–ï¼Œä½ éœ€è¦æ›´æœ‰æº«åº¦çš„é­”æ³•è¡¨é”ã€‚", 
            g: "ä½ éœ€è¦è£œå¼·ã€å•†æ¥­æ™ºèƒ½ (BI) èˆ‡ææ¡ˆé­…åŠ›ã€ã€‚åœ¨ææ¡ˆå·¥ä½œåŠä¸­ï¼Œä½ å°‡å­¸æœƒå¦‚ä½•å°‡æ·±å¥§çš„åˆ†æçµæœï¼Œè½‰åŒ–ç‚ºè®“äººå¿ƒæœå£æœçš„æ•‘ä¸–å»ºè­°æ›¸ã€‚"
        },
        "ENFP": { 
            t: "å¥‡è¹Ÿé¡˜æ™¯å¬å–šå¸«", 
            s: "ä½ çš„éˆæ„Ÿèƒ½å‰µé€ é©šå–œï¼Œè®“æ­»æ¿çš„è³‡æ–™å±•ç¾å‡ºç”Ÿæ©Ÿã€‚ä½†é­”æ³•éœ€è¦å …å¯¦çš„é™£åœ°ï¼Œéˆæ„Ÿä¹Ÿéœ€è¦åš´è¬¹çš„ç§‘å­¸é©—è­‰ã€‚", 
            g: "ä½ éœ€è¦ä¿®è¡Œã€æ–°è—¥é–‹ç™¼é‚è¼¯èˆ‡åˆ†ææ€ç¶­ã€ã€‚å­¸ç¿’å®Œæ•´çš„æ–°è—¥ç ”ç™¼æµç¨‹ï¼Œå°‡è®“ä½ å¤©é¦¬è¡Œç©ºçš„å‰µæ„è®Šæˆä¸€åŠ‘åŠ‘èƒ½ç©©å®šå–šé†’å…¨äººé¡çš„æ•‘ä¸–è‰¯è—¥ã€‚"
        }
    };

    function showResult() {
        document.getElementById('processing').classList.add('hidden');
        document.getElementById('result').classList.remove('hidden');

        if (!globalEndTime) {
            globalEndTime = Date.now() + 86400000; 
            startBackgroundTimer(); 
        }

        let mScores = { E:0, I:0, N:0, S:0, T:0, F:0, J:0, P:0 };
        let dScores = { innovation:0, logic:0, leadership:0, stability:0, causal:0 };

        userAnswers.forEach((ansIdx, qIdx) => {
            if (ansIdx === null || !questions[qIdx].options[ansIdx]) return;
            const weights = questions[qIdx].options[ansIdx].w;
            for(let k in weights) {
                if(mScores.hasOwnProperty(k)) mScores[k] += weights[k];
                if(dScores.hasOwnProperty(k)) dScores[k] += weights[k];
            }
        });

        const code = (mScores.E >= mScores.I ? "E" : "I") + (mScores.N >= mScores.S ? "N" : "S") + (mScores.T >= mScores.F ? "T" : "F") + (mScores.J >= mScores.P ? "J" : "P");
        document.getElementById('res-code').innerText = code;
        const info = mbtiMap[code] || mbtiMap["ENTJ"];
        document.getElementById('res-title').innerText = info.t;
        document.getElementById('res-story').innerText = info.s;
        document.getElementById('res-growth').innerText = info.g;

        const spec = document.getElementById('match-spectrum');
        const types = ["ENTJ", "INFP", "INTJ", "ENFP", "INTP"].filter(t => t !== code).sort(() => Math.random() - 0.5).slice(0,3);
        spec.innerHTML = `
            <div class="match-row">
                <span style="font-family:'Cinzel'; font-size:0.7rem; width:50px; color:var(--accent-warm); font-weight:900;">${code}</span>
                <div class="match-bar-bg"><div class="match-bar-fill" style="width:98%; background:var(--accent-warm);"></div></div>
                <span style="font-size:0.7rem; color:var(--accent-warm); font-weight:900;">98%</span>
            </div>`;
        types.forEach(t => {
            const p = Math.floor(Math.random() * 15) + 75;
            spec.innerHTML += `
                <div class="match-row">
                    <span style="font-family:'Cinzel'; font-size:0.7rem; width:50px; color:var(--text-bright);">${t}</span>
                    <div class="match-bar-bg"><div class="match-bar-fill" style="width:${p}%"></div></div>
                    <span style="font-size:0.7rem; color:var(--text-soft);">${p}%</span>
                </div>`;
        });

        drawRadar({
            innovation: Math.min(95, 45 + dScores.innovation * 12),
            logic: Math.min(95, 45 + dScores.logic * 12),
            leadership: Math.min(95, 40 + dScores.leadership * 12),
            stability: Math.min(95, 40 + dScores.stability * 12),
            causal: Math.min(95, 45 + dScores.causal * 12)
        });
    }

    function drawRadar(data) {
        const canvas = document.getElementById('radarChart');
        const ctx = canvas.getContext('2d');
        const size = 260;
        const dpr = window.devicePixelRatio || 2;
        canvas.width = size * dpr; canvas.height = size * dpr;
        canvas.style.width = size + 'px'; canvas.style.height = size + 'px';
        ctx.scale(dpr, dpr);
        const centerX = size / 2, centerY = size / 2, radius = 70;
        const labels = ["æ ¸å¿ƒå‰µæ–°åŠ›", "é‚è¼¯åˆ†æåŠ›", "é­”æ³•é ˜å°åŠ›", "æŠ€è¡“æ„ŸçŸ¥åŠ›", "å› æœæ´å¯ŸåŠ›"];
        const values = [data.innovation, data.logic, data.leadership, data.stability, data.causal];
        ctx.clearRect(0, 0, size, size);
        ctx.strokeStyle = "rgba(229, 192, 123, 0.2)"; 
        for (let j = 1; j <= 5; j++) {
            ctx.beginPath();
            const r = (radius / 5) * j;
            for (let i = 0; i < 5; i++) {
                const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
                ctx.lineTo(centerX + r * Math.cos(a), centerY + r * Math.sin(a));
            }
            ctx.closePath(); ctx.stroke();
        }
        ctx.beginPath();
        for (let i = 0; i < 5; i++) {
            const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
            const r = (values[i] / 100) * radius;
            ctx.lineTo(centerX + r * Math.cos(a), centerY + r * Math.sin(a));
        }
        ctx.closePath();
        ctx.fillStyle = "rgba(229, 192, 123, 0.4)"; ctx.fill();
        ctx.strokeStyle = "#e5c07b"; ctx.lineWidth = 2; ctx.stroke();
        ctx.fillStyle = "#fff"; ctx.font = "bold 11px 'Noto Sans TC'"; ctx.textAlign = "center";
        for (let i = 0; i < 5; i++) {
            const a = (i * 2 * Math.PI / 5) - Math.PI / 2;
            const tx = centerX + (radius + 24) * Math.cos(a);
            const ty = centerY + (radius + 24) * Math.sin(a) + 4;
            ctx.fillText(labels[i], tx, ty);
        }
    }

    window.resetTest = () => { currentStep = 0; userAnswers.fill(null); document.getElementById('result').classList.add('hidden'); document.getElementById('start').classList.remove('hidden'); };

    function startBackgroundTimer() {
        if(timerItv) clearInterval(timerItv);
        const updateUI = () => {
            if (!globalEndTime) return;
            const now = Date.now();
            let diff = Math.floor((globalEndTime - now) / 1000);
            if (diff <= 0) { diff = 0; clearInterval(timerItv); }
            const h = Math.floor(diff / 3600), m = Math.floor((diff % 3600) / 60), s = diff % 60;
            const timerEl = document.getElementById('timer-result');
            if (timerEl) { timerEl.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`; }
        };
        updateUI();
        timerItv = setInterval(updateUI, 1000);
    }

    window.copyCoupon = () => {
        const dummy = document.createElement('textarea'); dummy.value = "phdcenter_causal888";
        document.body.appendChild(dummy); dummy.select(); document.execCommand('copy');
        document.body.removeChild(dummy);
    };

    const users = ["æ—åŒå­¸", "é™³åŒå­¸", "å¼µåŒå­¸", "ç‹åŒå­¸", "æåŒå­¸", "è”¡åŒå­¸", "é«˜åŒå­¸", "å‘¨åŒå­¸", "å³åŒå­¸", "è¶™åŒå­¸"];
    const cities = ["å°åŒ—å¸‚", "å°ä¸­å¸‚", "é«˜é›„å¸‚", "å°å—å¸‚", "æ–°ç«¹å¸‚", "æ¡ƒåœ’å¸‚"];
    
    function triggerToast() {
        const nextTime = 45000 + Math.random() * 30000; 
        setTimeout(() => {
            const n = users[Math.floor(Math.random()*users.length)];
            const c = cities[Math.floor(Math.random()*cities.length)];
            const m = Math.floor(Math.random()*3) + 1;
            document.getElementById('toast-initial').innerText = n[0];
            document.getElementById('toast-content').innerText = `${n} å·²ç²å¾—å…¥å­¸è³‡æ ¼`;
            document.getElementById('toast-sub').innerText = `å‰›å‰› Â· ä¾†è‡ª${c}`;
            const t = document.getElementById('toast');
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 5000);
            triggerToast();
        }, nextTime);
    }
    triggerToast();
</script>
</body>
</html>
